import mainBG from './assets/main-bg.jpeg';
import demo1 from './assets/demo1.png';
import demo2 from './assets/demo2.png';
import demo3 from './assets/demo3.png';
import { Image } from 'astro:assets';

export const title =
  'Series SolidJS - Táº­p 3: Reactivity primitives trong SolidJS.';
export const date = '2023-02-10';
export const author = 'Pate Kem - @tunganh252';
export const desc =
  'ChÃ o cÃ¡c báº¡n, trong bÃ i viáº¿t nÃ y mÃ¬nh vÃ  cÃ¡c báº¡n sáº½ cÃ¹ng tÃ¬m hiá»ƒu vá» ğŸ“¥ Reactivity primitives cá»§a SolidJS nhÃ©.';
export const img = mainBG;
export const imgWidth = 1200;
export const imgHeight = 600;

## Giá»›i thiá»‡u

Hello everyone, chÃºng ta láº¡i gáº·p nhau ná»¯a rá»“i âœŒï¸\
Táº­p trÆ°á»›c trong series mÃ¬nh Ä‘Ã£ chia sáº» vá» cÃ¡ch khá»Ÿi táº¡o project **[SolidJS](https://www.solidjs.com/)** vÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cÆ¡ báº£n cá»§a 1 á»©ng dá»¥ng SolidJS.

Trong táº­p 3 nÃ y mÃ¬nh vÃ  cÃ¡c báº¡n sáº½ cÃ¹ng tÃ¬m hiá»ƒu vá» ğŸ“¥ **[Reactivity primitives](https://www.solidjs.com/guides/reactivity)** cá»§a **[SolidJS](https://www.solidjs.com/)** nhÃ©.

## Ná»™i dung

- ğŸ“¥ **[Reactivity primitives](https://www.solidjs.com/guides/reactivity)**
  - _Signals_
  - _Effects_
  - _Memo_

**"Reactivity primitives"** lÃ  má»™t khÃ¡i niá»‡m trong láº­p trÃ¬nh web vÃ  lÃ  má»™t pháº§n cá»§a cÃ¡c ká»¹ thuáº­t xá»­ lÃ½ tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng trÃªn giao diá»‡n. NÃ³ bao gá»“m cÃ¡c phÆ°Æ¡ng thá»©c cÆ¡ báº£n Ä‘á»ƒ **xá»­ lÃ½ cÃ¡c sá»± kiá»‡n tÆ°Æ¡ng tÃ¡c vÃ  cáº­p nháº­t giao diá»‡n** theo thá»i gian thá»±c.

`Vd: thao tÃ¡c nháº¥n vÃ o má»™t nÃºt trÃªn web lÃ  má»™t phÆ°Æ¡ng thá»©c tÆ°Æ¡ng tÃ¡c cÆ¡ báº£n vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xá»­ lÃ½ sá»± kiá»‡n nháº¥p chuá»™t hoáº·c gÃµ tá»« báº¥m phÃ­m.`

---

### **[Reactivity primitives](https://www.solidjs.com/guides/reactivity)** - Signals lÃ  gÃ¬?

LÃ  má»™t trong nhá»¯ng Ä‘á»‹nh nghÄ©a ná»n táº£ng cá»§a **reactivity primitives** trong Solid, nÃ³ thá»ƒ hiá»‡n 1 tráº¡ng thÃ¡i, 1 giÃ¡ trá»‹, 1 chá»©c nÄƒng, dá»¯ liá»‡u hay tÃ­n hiá»‡u mÃ  báº¡n cáº§n thá»ƒ hiá»‡n trong giao diá»‡n...

khi báº¡n thay Ä‘á»•i giÃ¡ trá»‹ cá»§a **signals**, nÃ³ sáº½ tá»± Ä‘á»™ng cáº­p nháº­t Ä‘áº¿n báº¥t kÃ¬ nÆ¡i nÃ o vÃ  báº¥t kÃ¬ thá»© gÃ¬ Ä‘ang sá»­ dá»¥ng giÃ¡ trá»‹ cá»§a **signals** Ä‘Ã³.

Khá»Ÿi táº¡o 1 signals:

```jsx
import { createSignal } from 'solid-js';

const [count, setCount] = createSignal(0);
```

á» Ä‘Ã¢y chÃºng ta cÃ³ thá»ƒ hiá»ƒu nhÆ° sau:

- Äá»‘i sá»‘ mang giÃ¡ trá»‹ **`0`** Ä‘Æ°á»£c truyá»n cho hÃ m **`createSignal()`** Ä‘Æ°á»£c gá»i lÃ  **giÃ¡ trá»‹ khá»Ÿi táº¡o**.
- GiÃ¡ trá»‹ tráº£ vá» lÃ  má»™t máº£ng cÃ³ gá»“m hai hÃ m chá»©c nÄƒng. Sá»­ dá»¥ng **destructuring** trong Javascript Ä‘á»ƒ cÃ³ thá»ƒ thá»ƒ Ä‘áº·t tÃªn cho cÃ¡c function nÃ y. MÃ¬nh Ä‘áº·t tÃªn cho hÃ m getter lÃ  `count` vÃ  setter lÃ  `setCount` nhÃ©.
- á» vÃ­ dá»¥ trÃªn náº¿u chÃºng ta muá»‘n log ra giÃ¡ trá»‹ `count` thÃ¬ sáº½ khÃ´ng Ä‘Æ°á»£c, thay vÃ o Ä‘áº¥y chÃºng ta pháº£i gá»i hÃ m `count()` Ä‘á»ƒ nháº­n Ä‘Æ°á»£c giÃ¡ trá»‹ tráº£ vá» nhÆ° mong muá»‘n.

```jsx
console.log(count); // khÃ´ng tráº£ vá» giÃ¡ trá»‹
console.log(count()); // 0
```

- HÃ m `setCount()` dÃ¹ng Ä‘á»ƒ cáº­p nháº­t láº¡i giÃ¡ trá»‹ tráº£ vá» (sá»‘ Ä‘áº¿m)

```jsx
// ChÃºng ta cÃ³ 2 cÃ¡ch viáº¿t nhÆ° sau
setCount(count() + 1);
setCount(c => c + 1);
```

> Báº¡n cÃ³ tháº¥y syntax giá»‘ng trong ReactJS khÃ´ng? ğŸ˜
> HÃ£y comment cho mÃ¬nh biáº¿t Signals cÃ³ gÃ¬ giá»‘ng hay khÃ¡c vá»›i **`useState`** trong **ReactJS** nhÃ©.

### **[Reactivity primitives](https://www.solidjs.com/guides/reactivity)** - Effects lÃ  gÃ¬?

Signals lÃ  cÃ¡c giÃ¡ trá»‹ mÃ  ta cÃ³ thá»ƒ theo dÃµi vÃ  sá»­ dá»¥ng, nhÆ°ng chÃºng chá»‰ lÃ  má»™t ná»­a cá»§a cÃ¢u chuyá»‡n.

**Effects** thá»±c thi dá»±a vÃ o sá»± thay Ä‘á»•i giÃ¡ trá»‹ cá»§a Signals. LÃºc nÃ y **Effects** táº¡o ra má»™t `side effect` (tÃ¡c dá»¥ng phá»¥) phá»¥ thuá»™c vÃ o tÃ­n hiá»‡u Signals.

```jsx
const [count, setCount] = createSignal(0);

createEffect(() => {
  console.log('The count is now', count());
});
```

MÃ¬nh cÃ³ 1 vÃ­ dá»¥ nhá» vá» viá»‡c Ä‘áº¿m sá»‘ nhÆ° sau:

```jsx
import { render } from 'solid-js/web';
import { createSignal, createEffect } from 'solid-js';

function Counter() {
  const [count, setCount] = createSignal(0);

  createEffect(() => {
    console.log('The count is now', count());
  });

  return (
    <button onClick={() => setCount(count() + 1)}>Click Me {count()}</button>
  );
}

render(() => <Counter />, document.getElementById('app'));
```

> CÃ¡c báº¡n cÃ³ thá»ƒ copy Ä‘oáº¡n code trÃªn vÃ  paste vÃ o https://playground.solidjs.com/ Ä‘á»ƒ cháº¡y vd trá»±c tiáº¿p nhÃ©, hoáº·c báº¡n cÃ³ thá»ƒ thá»­ ngay trÃªn chÃ­nh source code Ä‘Ã£ táº¡o á»Ÿ táº­p trÆ°á»›c ^^

MÃ¬nh sáº½ giáº£i thÃ­ch vd trÃªn nhÆ° sau:

- ChÃºng ta Ä‘Ã£ khá»Ÿi táº¡o 1 Signals vá»›i giÃ¡ trá»‹ lÃ  0
- Sau Ä‘áº¥y tiáº¿p tá»¥c chÃºng ta sá»­ dá»¥ng hÃ m **createEffect()** vÃ  truyá»n vÃ o trong Ä‘Ã³ 1 function Ä‘á»ƒ log (hiá»ƒn thá»‹ trÃªn `tab Console`) ra giÃ¡ trá»‹ sá»‘ Ä‘áº¿m hiá»‡n táº¡i `count()`
- Tiáº¿p Ä‘áº¿n á»Ÿ pháº§n giao diá»‡n ta cÃ³ 1 button, khi click sáº½ tÄƒng sá»‘ Ä‘áº¿m lÃªn +1 Ä‘Æ¡n vá»‹

Khi chÃºng ta sá»­ dá»¥ng hÃ m **createEffect()** nÃ³ sáº½ luÃ´n táº¡o ra 1 pháº£n á»©ng phá»¥ (side effect) Ä‘á»ƒ cho ta biáº¿t Ä‘Æ°á»£c giÃ¡ trá»‹ `count()` thay Ä‘á»•i ra sao

TrÆ°á»›c khi chÃºng ta click vÃ o button `Click Me` thÃ¬ side effect nÃ y Ä‘Ã£ Ä‘Æ°á»£c thá»±c thi vÃ  nÃ³ Ä‘Ã£ `console.log("The count is now", count())` ra giÃ¡ trá»‹ khá»Ÿi táº¡o **(initial value)** ban Ä‘áº§u chÃ­nh lÃ  sá»‘ **`0`**

<Image src={demo1} alt='demo1' />

Tiáº¿p sau Ä‘áº¥y má»—i láº§n chÃºng ta click vÃ o button `Click Me` thÃ¬ giÃ¡ trá»‹ sá»‘ Ä‘áº¿m `count()` sáº½ tÄƒng lÃªn 1 Ä‘Æ¡n vá»‹ --> cÅ©ng Ä‘á»“ng nghÄ©a vá»›i viá»‡c xáº£y ra 1 side effect (pháº£n á»©ng phá»¥) `console.log("The count is now", count())`

<Image src={demo2} alt='demo2' />

---

> Báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng nhiá»u hÃ m **createEffect()**, má»—i Effect sáº½ sinh ra `side effect` theo tá»«ng Signal trong cÃ¹ng 1 **`Component <Counter />`**

```jsx
import { render } from 'solid-js/web';
import { createSignal, createEffect } from 'solid-js';

function Counter() {
  const [count, setCount] = createSignal(0);
  const [name, setName] = createSignal('TÃ¹ng Anh Nguyá»…n');

  createEffect(() => {
    console.log('The count is now', count());
  });

  createEffect(() => {
    console.log('My name is ', name());
  });

  const handleClick = () => {
    // CÃ¡ch update signal gá»i trá»±c tiáº¿p hÃ m getter lÃ  count()
    setCount(count() + 1);

    // Signal cháº¥p nháº­n 1 hÃ m sá»­ dá»¥ng giÃ¡ trá»‹ trÆ°á»›c Ä‘Ã³ Ä‘áº·t cho giÃ¡ trá»‹ tiáº¿p theo.
    setName(name => name + ' (Jeremy)');
  };

  return (
    <button onClick={handleClick}>
      Click Me: {name()} - {count()}
    </button>
  );
}

render(() => <Counter />, document.getElementById('app'));
```

<Image src={demo3} alt='demo3' />

### **[Reactivity primitives](https://www.solidjs.com/guides/reactivity)** - Memos lÃ  gÃ¬?

Háº§u háº¿t cÃ¡c cÃ´ng viá»‡c chÃºng ta gáº·p pháº£i Ä‘á»u cÃ³ thá»ƒ sá»­ dá»¥ng Signals lÃ  Ä‘á»§ yÃªu cáº§u. Tuy nhiÃªn Ä‘Ã´i lÃºc chÃºng ta sáº½ gáº·p pháº£i nhá»¯ng trÆ°á»ng há»£p pháº£i xá»­ lÃ½ cÃ¡c cÃ´ng viá»‡c láº·p Ä‘i láº·p láº¡i. Váº­y Ä‘Ã¢u lÃ  giáº£i phÃ¡p? ğŸ§

**`createMemo`** táº¡o ra tÃ­n hiá»‡u (Signal) vá»›i cÃ´ng viá»‡c chÃ­nh lÃ  Ä‘á»c, tÃ­nh toÃ¡n láº¡i giÃ¡ trá»‹ cá»§a nÃ³ báº¥t cá»© khi nÃ o giÃ¡ trá»‹ cÃ³ sá»± thay Ä‘á»•i, cáº­p nháº­t.

ChÃºng ta sáº½ sá»­ dá»¥ng **`createMemo`** khi muá»‘n lÆ°u vÃ o bá»™ nhá»› Ä‘á»‡m má»™t sá»‘ giÃ¡ trá»‹ vÃ  truy cáº­p chÃºng mÃ  khÃ´ng cáº§n xem xÃ©t viá»‡c truy xuáº¥t láº¡i chÃºng, cho Ä‘áº¿n khi má»™t giÃ¡ trá»‹ phá»¥ thuá»™c (dependence) thay Ä‘á»•i.

---

VÃ­ dá»¥: mÃ¬nh muá»‘n hiá»ƒn thá»‹ sá»‘ Ä‘áº¿m `count()` 100 láº§n vÃ  cáº­p nháº­t giÃ¡ trá»‹ sá»‘ Ä‘áº¿m khi nháº¥p vÃ o nÃºt (button) ---> sá»­ dá»¥ng **`createMemo()`** sáº½ cho phÃ©p viá»‡c tÃ­nh toÃ¡n láº¡i chá»‰ xáº£y ra má»™t láº§n cho má»—i láº§n click

```jsx
import { render } from 'solid-js/web';
import { createSignal, createMemo } from 'solid-js';

function Counter() {
  const [count, setCount] = createSignal(0);
  // Náº¿u chÃºng ta khÃ´ng bá»c nÃ³ trong createMemo
  // Viá»‡c tÃ­nh toÃ¡n vÃ  thá»ƒ hiá»‡n giÃ¡ trá»‹ sáº½ xáº£y ra 100 láº§n cho má»—i láº§n click
  // const counter = () => {
  //    return count();
  // }

  // NgÆ°á»£c láº¡i náº¿u chÃºng ta bá»c nÃ³ trong createMemo
  // Viá»‡c tÃ­nh toÃ¡n láº¡i vÃ  thá»ƒ hiá»‡n giÃ¡ trá»‹ chá»‰ xáº£y ra má»™t láº§n cho má»—i láº§n click
  const counter = createMemo(() => {
    return count();
  });

  return (
    <>
      <button onClick={() => setCount(count() + 1)}>Count: {count()}</button>
      <div>1. {counter()}</div>
      <div>2. {counter()}</div>
      <div>3. {counter()}</div>
      <div>4. {counter()}</div>
      <div>5. {counter()}</div>

      <p>95 more times...</p>
    </>
  );
}

render(() => <Counter />, document.getElementById('app'));
```

```jsx
// Náº¿u chÃºng ta khÃ´ng bá»c nÃ³ trong createMemo
// Viá»‡c tÃ­nh toÃ¡n vÃ  thá»ƒ hiá»‡n giÃ¡ trá»‹ sáº½ xáº£y ra 100 láº§n cho má»—i láº§n click
const counter = () => {
  return count();
};

// NgÆ°á»£c láº¡i náº¿u chÃºng ta bá»c nÃ³ trong createMemo
// Viá»‡c tÃ­nh toÃ¡n láº¡i vÃ  thá»ƒ hiá»‡n giÃ¡ trá»‹ chá»‰ xáº£y ra má»™t láº§n cho má»—i láº§n click
const counter = createMemo(() => {
  return count();
});
```

Äiá»u nÃ y ráº¥t cÃ³ lá»£i cho viá»‡c tÃ­nh toÃ¡n vÃ  sá»­ dá»¥ng bá»™ nhá»› cá»§a cÃ¡c effect, dá»¯ liá»‡u cÃ³ cÃ¡c thÃ nh pháº§n phá»¥ thuá»™c vÃ  hÆ¡n háº¿t lÃ  **giáº£m thiá»ƒu cÃ´ng viá»‡c** cáº§n pháº£i lÃ m **cho cÃ¡c hoáº¡t Ä‘á»™ng tá»‘n kÃ©m** hiá»‡u suáº¥t nhÆ° táº¡o DOM, tÃ­nh toÃ¡n giÃ¡ trá»‹....

## Tá»•ng káº¿t láº¡i táº­p 3 thÃ´i nÃ o

Táº­p 3 nÃ y chÃºng ta Ä‘Ã£ cÃ¹ng tÃ¬m hiá»ƒu vá» cÃ¡c tÃ­nh nÄƒng chÃ­nh cá»§a **[Reactivity primitives](https://www.solidjs.com/guides/reactivity)** nhÆ° _Signals_, _Effects_ vÃ  _Memos_

Trong táº­p sau mÃ¬nh sáº½ cÃ¹ng Ä‘i vÃ o pháº§n tiáº¿p theo:

ğŸ”„ **[Lifecycle methods](https://www.solidjs.com/docs/latest/api#lifecycles)**

- _onMount_
- _onCleanup_
- _onError_

Cáº£m Æ¡n cÃ¡c báº¡n Ä‘Ã£ theo dÃµi táº­p 3 trong series vá» **[SolidJS](https://www.solidjs.com/)**.

### Tham kháº£o

https://www.solidjs.com/tutorial/introduction_signals
https://www.solidjs.com/tutorial/introduction_effects
https://www.solidjs.com/tutorial/introduction_memos
